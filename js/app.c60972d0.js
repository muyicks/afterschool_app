(function(){"use strict";var t={5158:function(t,e,s){var r=s(5471),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-dark fs-3 p-3 ms-auto mb-3",on:{click:t.toggleCartView}},[e("i",{staticClass:"fa fa-cart-plus"}),e("span",{staticClass:"badge bg-danger"},[t._v(t._s(t.cartSize))])])]),e(t.activeComponent,{tag:"component",attrs:{lessons:t.lessons,cart:t.cart,baseURL:t.baseURL},on:{"remove-from-cart":t.removeProduct,"add-to-cart":t.addToCart,"order-submitted":t.resetCart}})],1)},o=[],n=(s(4114),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"container"},[e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchTerm,expression:"searchTerm"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Search Product..."},domProps:{value:t.searchTerm},on:{input:[function(e){e.target.composing||(t.searchTerm=e.target.value)},t.searchLessons]}})]),e("div",[e("label",{attrs:{for:"sortAttribute"}},[t._v("Sort By:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.sortAttribute,expression:"sortAttribute"}],staticClass:"form-select",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.sortAttribute=e.target.multiple?s:s[0]},t.searchLessons]}},[e("option",{attrs:{value:"title"}},[t._v("Title")]),e("option",{attrs:{value:"subject"}},[t._v("Subject")]),e("option",{attrs:{value:"location"}},[t._v("Location")]),e("option",{attrs:{value:"price"}},[t._v("Price")]),e("option",{attrs:{value:"spaces"}},[t._v("spaces")])])]),e("div",[e("label",{attrs:{for:"sortOrder"}},[t._v("Sort Order:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.sortOrder,expression:"sortOrder"}],staticClass:"form-select mb-3",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.sortOrder=e.target.multiple?s:s[0]},t.searchLessons]}},[e("option",{attrs:{value:"asc"}},[t._v("Ascending")]),e("option",{attrs:{value:"desc"}},[t._v("Descending")])])]),e("div",{staticClass:"row"},t._l(t.localLessons,(function(s){return e("div",{key:s._id,staticClass:"col-sm-4"},[e("div",{staticClass:"card mb-3 rounded-0 border border-success-subtle"},[e("div",{staticClass:"card-header d-flex"},[e("div",[e("p",[t._v("Subject: "+t._s(s.subject))]),e("h5",[t._v("Title: "+t._s(s.title))])]),e("i",{staticClass:"fs-1 ms-auto",class:s.icon})]),e("div",{staticClass:"card-body"},[e("p",[t._v(" Price: "+t._s(s.price)+" "),e("i",{staticClass:"fa fa-eur"},[t._v(" per hour")])]),e("p",[t._v("Location: "+t._s(s.location))]),e("p",[t._v("spaces: "+t._s(s.spaces))])]),e("div",{staticClass:"card-footer"},[e("button",{attrs:{disabled:0===s.spaces},on:{click:function(e){return t.addToCart(s)}}},[e("i",{staticClass:"fa fa-cart-plus"})]),e("button",{on:{click:function(e){return t.removeProduct(s)}}},[e("i",{staticClass:"fa fa-minus-circle"})])])])])})),0)])])}),i=[],c={props:["lessons","cart","baseURL"],data(){return{searchTerm:"",sortOrder:"asc",sortAttribute:"subject",localLessons:[]}},watch:{lessons:{handler(t){this.localLessons=[...t]},immediate:!0,deep:!0}},methods:{async searchLessons(){try{const t={search:this.searchTerm,sort:this.sortAttribute,order:this.sortOrder},e=await fetch(`${this.baseURL}search/collection/lessons/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error("Failed to fetch lessons");const s=await e.json();this.localLessons=s}catch(t){console.error(t)}},checkItemCount(t){return this.cart.reduce(((e,s)=>e+(s.lesson._id===t?s.amount:0)),0)},addToCart(t){this.canAddToCart(t)&&this.$emit("add-to-cart",t)},removeProduct(t){this.$emit("remove-from-cart",t)},canAddToCart(t){return t.spaces>this.checkItemCount(t._id)}},computed:{cartSize(){return this.cart.reduce(((t,e)=>t+e.amount),0)},cartTotal(){return this.cart.reduce(((t,e)=>t+e.amount*e.lesson.price),0)}}},l=c,u=s(1656),d=(0,u.A)(l,n,i,!1,null,null,null),p=d.exports,m=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"container mt-4"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-8 border rounded-3"},[t._l(t.cart,(function(s){return e("div",{key:s.lesson._id,staticClass:"border-bottom"},[e("div",{staticClass:"col-sm-12 mb-4 p-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-4"},[e("i",{staticClass:"display-1 ms-auto",class:s.lesson.icon})]),e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Title: "+t._s(s.lesson.title))]),e("p",[t._v("Quantity: "+t._s(s.amount))]),e("p",[e("button",{on:{click:function(e){return t.$emit("remove-from-cart",s.lesson)}}},[e("i",{staticClass:"fa fa-minus-circle"})])])]),e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Price: "+t._s(s.lesson.price)+" "),e("i",{staticClass:"fa fa-eur"},[t._v(" per hour")])])])])])])})),e("div",{staticClass:"col-sm-12"},[e("p",[t._v("Total Price: "+t._s(t.cartTotal)+" "),e("i",{staticClass:"fa fa-eur"})])])],2),e("div",{staticClass:"col-sm-4 mt-4"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("h5",{staticClass:"card-title"},[t._v("Details")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submitOrder.apply(null,arguments)}}},[e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"username"}},[t._v("Name")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control",attrs:{type:"text",id:"username",name:"username",placeholder:"Name",required:""},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"phone"}},[t._v("Number")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"form-control",attrs:{type:"tel",id:"phone",name:"phone",placeholder:"Number",required:""},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:!t.completeOrder}},[t._v("Submit")])])])])])])])])])])])},v=[],h={props:["cart","baseURL"],data(){return{username:"",phone:""}},methods:{async submitOrder(){try{const e={cart:[...this.cart],username:this.username,phone:this.phone},s=await fetch(`${this.baseURL}collection/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});this.cart.forEach((t=>{fetch(`${this.baseURL}collection/lessons/${t.lesson._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({spaces:t.lesson.spaces})})}));const r=await s.text();console.log("Response Text:",r);try{const t=JSON.parse(r);if(!s.ok)throw new Error(t.message||"Failed to submit order");alert("Order submitted successfully!"),this.$emit("order-submitted")}catch(t){throw new Error(`Unexpected response format: ${r}`)}}catch(e){console.error("Error:",e.message),alert(`There was an error submitting your order: ${e.message}`)}}},computed:{completeOrder(){return/^[a-zA-Z]+$/.test(this.username)&&/^\d+$/.test(this.phone)},cartTotal(){return this.cart.reduce(((t,e)=>t+e.amount*e.lesson.price),0)}}},f=h,b=(0,u.A)(f,m,v,!1,null,null,null),C=b.exports,_={name:"App",data(){return{lessons:[],cart:[],baseURL:"https://afterskoolbackend.vercel.app/",activeComponent:"LessonComponent"}},methods:{async getLessons(){var t=await fetch(`${this.baseURL}collection/lessons`);this.lessons=await t.json()},removeProduct(t){const e=this.cart.findIndex((e=>e.lesson._id===t._id));-1!==e&&(this.cart[e].amount--,t.spaces+=1,0==this.cart[e].amount&&this.cart.splice(e,1))},addToCart(t){if(t.spaces>0){t.spaces--;var e=this.cart.findIndex((e=>e.lesson._id===t._id));e>-1?this.cart[e].amount++:this.cart.push({lesson:t,amount:1})}},toggleCartView(){this.activeComponent="LessonComponent"===this.activeComponent?"CheckoutComponent":"LessonComponent"},resetCart(){this.cart=[]}},computed:{cartSize(){return this.cart.reduce(((t,e)=>t+e.amount),0)}},components:{LessonComponent:p,CheckoutComponent:C},mounted(){this.getLessons()}},y=_,g=(0,u.A)(y,a,o,!1,null,null,null),w=g.exports;r.Ay.config.productionTip=!1,new r.Ay({render:t=>t(w)}).$mount("#app")}},e={};function s(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,r,a,o){if(!r){var n=1/0;for(u=0;u<t.length;u++){r=t[u][0],a=t[u][1],o=t[u][2];for(var i=!0,c=0;c<r.length;c++)(!1&o||n>=o)&&Object.keys(s.O).every((function(t){return s.O[t](r[c])}))?r.splice(c--,1):(i=!1,o<n&&(n=o));if(i){t.splice(u--,1);var l=a();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[r,a,o]}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var a,o,n=r[0],i=r[1],c=r[2],l=0;if(n.some((function(e){return 0!==t[e]}))){for(a in i)s.o(i,a)&&(s.m[a]=i[a]);if(c)var u=c(s)}for(e&&e(r);l<n.length;l++)o=n[l],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(u)},r=self["webpackChunkafterschool_app"]=self["webpackChunkafterschool_app"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],(function(){return s(5158)}));r=s.O(r)})();
//# sourceMappingURL=app.c60972d0.js.map